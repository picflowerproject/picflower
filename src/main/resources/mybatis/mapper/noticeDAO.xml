<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper 
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.picflower.dao.InoticeDAO">

    <!-- [수정] 목록 조회 시 n_text 제외 (데이터 용량 과부하 방지) -->
    <select id="n_listDao" resultType="com.picflower.dto.noticeDTO"> 
        SELECT n_no, n_title, n_date 
        FROM notice 
        ORDER BY n_no DESC
    </select>

    <!-- 페이징 리스트 조회 시 n_text 제외 -->
    <select id="n_listPagedDao" resultType="com.picflower.dto.noticeDTO">
        SELECT n_no, n_title, n_text, n_date 
        FROM notice 
        ORDER BY n_no DESC 
        OFFSET #{offset} ROWS FETCH NEXT #{size} ROWS ONLY
    </select>

    <!-- [유지] 공지 입력 -->
    <insert id="n_insertDao">
        INSERT INTO notice (n_no, n_title, n_text, n_date)
        VALUES (
            notice_seq.nextval, 
            #{n_title, jdbcType=VARCHAR}, 
            #{n_text, jdbcType=CLOB}, 
            SYSDATE
        )
    </insert>

    <!-- [유지] 공지 수정 -->
    <update id="n_updateDao">
        UPDATE notice 
        SET n_title = #{n_title, jdbcType=VARCHAR}, 
            n_text = #{n_text, jdbcType=CLOB}, 
            n_date = SYSDATE
        WHERE n_no = #{n_no}
    </update>

    <delete id="n_deleteDao">
        DELETE FROM notice WHERE n_no = #{n_no}
    </delete>
    
    <select id="getTotalCount" resultType="int">
        SELECT COUNT(*) FROM notice
    </select>
</mapper>